<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit Converter</title>
  <link rel="manifest" href="manifest.json">

  <style>
    /* ------------------------------
       GLOBAL STYLES
    ------------------------------ */
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #002B60;
      color: #72C7FC;
      transition: background 0.3s, color 0.3s;
      padding-top: 130px;
      padding-bottom: 90px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    /* ------------------------------
       DARK MODE
    ------------------------------ */
    body.dark {
      background-color: #0A1A33;
      color: #CFE8FF;
    }

    body.dark .card {
      background: #0F2A4F;
      border-color: rgba(255,255,255,0.15);
    }

    body.dark input,
    body.dark select {
      background-color: #0F3A6A;
      color: #CFE8FF;
      border-color: #CFE8FF;
    }

    body.dark button {
      background: linear-gradient(180deg, #4A6BB0, #324A7A);
      color: #E8F1FF;
    }

    body.dark .bottom-toolbar {
      background: #0A1A33;
      border-top-color: rgba(255,255,255,0.2);
    }

    /* ------------------------------
       INPUTS & SELECTS
    ------------------------------ */
    input,
    select {
      padding: 12px;
      font-size: 1.1rem;
      margin: 8px 0;
      width: 100%;
      max-width: 320px;
      background-color: #02519C;
      color: #72C7FC;
      border: 1px solid #72C7FC;
      border-radius: 6px;
      display: block;
      margin-left: auto;
      margin-right: auto;
      transition: box-shadow 0.2s ease, transform 0.1s ease;
    }

    input:focus,
    select:focus {
      outline: none;
      box-shadow: 0 0 12px rgba(114,199,252,0.7);
      transform: translateY(-1px);
    }

    /* ------------------------------
       iOS STYLE BUTTONS + HAPTIC
    ------------------------------ */
    button {
      width: 100%;
      max-width: 320px;
      padding: 14px 20px;
      margin: 14px auto;
      font-size: 1.15rem;
      font-weight: 600;
      background: linear-gradient(180deg, #3A5BA0, #2C447A);
      color: #E8F1FF;
      border: none;
      border-radius: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.35);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      cursor: pointer;
    }

    button:active {
      transform: scale(0.96);
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }

    .btn-icon {
      width: 22px;
      height: 22px;
      object-fit: contain;
    }

    .haptic-tap {
      animation: hapticTap 120ms ease-out;
    }

    @keyframes hapticTap {
      0% { transform: scale(1); }
      50% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }

    /* ------------------------------
       RESULT DISPLAY + FADE-IN
    ------------------------------ */
    #result {
      margin-top: 25px;
      font-size: 2.4rem;
      font-weight: bold;
      text-align: center;
      color: #43B6FE;
      min-height: 2.4rem;
    }

    .result-updated {
      animation: resultFade 0.25s ease-out;
    }

    @keyframes resultFade {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ------------------------------
       FIXED HEADER
    ------------------------------ */
    .app-header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 120px;
      background: #001A3D;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }

    .header-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    /* ------------------------------
       CARD LAYOUT
    ------------------------------ */
    .card {
      background: #01356F;
      padding: 25px 20px;
      border-radius: 16px;
      max-width: 380px;
      margin: 0 auto;
      box-shadow: 0 6px 20px rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.08);
      opacity: 0;
      transform: translateY(10px);
      animation: cardFade 0.4s ease forwards;
    }

    @keyframes cardFade {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ------------------------------
       BOTTOM TOOLBAR
    ------------------------------ */
    .bottom-toolbar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 70px;
      background: #001A3D;
      border-top: 1px solid rgba(255,255,255,0.15);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 22px;
      box-shadow: 0 -4px 12px rgba(0,0,0,0.35);
      z-index: 999;
    }

    .toolbar-left {
      display: flex;
      gap: 18px;
    }

    .toolbar-btn {
      background: none;
      border: none;
      color: #A0C9FF;
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6px;
      border-radius: 10px;
      transition: background 0.2s, transform 0.15s;
    }

    .toolbar-btn:active {
      transform: scale(0.92);
      background: rgba(255,255,255,0.1);
    }

    .toolbar-icon {
      width: 26px;
      height: 26px;
      object-fit: contain;
    }

    .category-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 0.9rem;
      font-weight: 700;
      color: #E8F1FF;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      background: linear-gradient(180deg, #3A5BA0, #2C447A);
    }

    /* ------------------------------
       CATEGORY PICKER MODAL
    ------------------------------ */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: flex;
      justify-content: center;
      align-items: flex-end;
      z-index: 2000;
      transition: opacity 0.25s ease;
    }

    .modal-backdrop.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .modal-sheet {
      width: 100%;
      max-width: 420px;
      background: #01356F;
      padding: 25px;
      border-radius: 22px 22px 0 0;
      box-shadow: 0 -6px 20px rgba(0,0,0,0.4);
      animation: slideUp 0.25s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(40px); opacity: 0; }
      to   { transform: translateY(0); opacity: 1; }
    }

    .modal-sheet h2 {
      text-align: center;
      margin-bottom: 18px;
      color: #E8F1FF;
    }

    .modal-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .modal-option-btn {
      padding: 14px;
      border-radius: 12px;
      background: #02519C;
      color: #E8F1FF;
      font-size: 1.1rem;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.15);
      transition: background 0.2s, transform 0.1s;
      cursor: pointer;
    }

    .modal-option-btn:active {
      background: #013A78;
      transform: scale(0.97);
    }
  </style>
</head>

<body class="dark">

  <!-- FIXED HEADER -->
  <header class="app-header">
    <img src="header.jpg" alt="Header Image" class="header-img">
  </header>

  <!-- CARD -->
  <div class="card">

    <h1>Unit Converter</h1>

    <input 
      id="inputValue"
      type="text"
      inputmode="decimal"
      pattern="[0-9]*"
      placeholder="Enter value"
    >

    <select id="fromUnit"></select>
    <select id="toUnit"></select>

    <button id="swapBtn">
      <img src="swap.png" class="btn-icon" onerror="this.style.display='none'; this.parentNode.textContent='swap';">
      Swap Units
    </button>

    <div id="result"></div>

  </div>

  <!-- BOTTOM TOOLBAR -->
  <div class="bottom-toolbar">

    <div class="toolbar-left">

      <button class="toolbar-btn" id="modeBtn">
        <img src="mode.png" class="toolbar-icon"
             onerror="this.style.display='none'; this.parentNode.textContent='mode';">
      </button>

      <button class="toolbar-btn" id="themeBtn">
        <img src="theme.png" class="toolbar-icon"
             onerror="this.style.display='none'; this.parentNode.textContent='theme';">
      </button>

    </div>

    <button class="toolbar-btn category-btn" id="categoryBtn">
      <img src="category.png" class="toolbar-icon"
           onerror="this.style.display='none'; this.parentNode.textContent='category';">
    </button>

  </div>

  <!-- CATEGORY PICKER MODAL -->
  <div id="categoryModal" class="modal-backdrop hidden">
    <div class="modal-sheet">
      <h2>Select Category</h2>
      <div id="categoryList" class="modal-options"></div>
    </div>
  </div>

  <script>
    /* ============================================================
       CLASS: ConverterEngine
    ============================================================ */
    class ConverterEngine {
      constructor() {
        this.categories = {
          volume: ["cups", "ounces", "tablespoons", "teaspoons", "pints", "quarts", "gallons"],
          temperature: ["celsius", "fahrenheit"],
          weight: ["grams", "kilograms", "ounces", "pounds"],
          speed: ["kmh", "mph", "knots"],
          timezone: ["UTC", "MST", "CST", "EST", "PST"],
          length: ["cm", "m", "inches", "feet", "km", "miles"],
          currency: ["EUR", "USD", "GBP", "CAD", "AUD"]
        };

        this.defaults = {
          volume: ["tablespoons", "cups"],
          temperature: ["celsius", "fahrenheit"],
          weight: ["kilograms", "pounds"],
          speed: ["kmh", "mph"],
          timezone: ["UTC", "MST"],
          length: ["cm", "inches"],
          currency: ["EUR", "USD"]
        };
      }

      getUnits(category) {
        return this.categories[category] || [];
      }

      getDefaultUnits(category) {
        return this.defaults[category] || [];
      }

      convert(category, value, from, to) {
        if (isNaN(value)) return "";

        switch (category) {
          case "volume":
            const vol = {
              cups: 1,
              ounces: 8,
              tablespoons: 16,
              teaspoons: 48,
              pints: 0.5,
              quarts: 0.25,
              gallons: 0.0625
            };
            return value * (vol[to] / vol[from]);

          case "temperature":
            if (from === "celsius" && to === "fahrenheit") return value * 9/5 + 32;
            if (from === "fahrenheit" && to === "celsius") return (value - 32) * 5/9;
            return value;

          case "weight":
            const wt = {
              grams: 1,
              kilograms: 1000,
              ounces: 28.3495,
              pounds: 453.592
            };
            return value * (wt[to] / wt[from]);

          case "speed":
            const spd = {
              kmh: 1,
              mph: 1.60934,
              knots: 1.852
            };
            return value * (spd[to] / spd[from]);

          case "timezone":
            const tz = {
              UTC: 0,
              MST: -7,
              CST: -6,
              EST: -5,
              PST: -8
            };
            return value + (tz[to] - tz[from]);

          case "length":
            const len = {
              cm: 1,
              m: 100,
              inches: 2.54,
              feet: 30.48,
              km: 100000,
              miles: 160934
            };
            return value * (len[to] / len[from]);

          case "currency":
            const rates = {
              EUR: 1,
              USD: 1.09,
              GBP: 0.86,
              CAD: 1.47,
              AUD: 1.63
            };
            return value * (rates[to] / rates[from]);
        }
      }
    }

    /* ============================================================
       CLASS: ThemeManager
    ============================================================ */
    class ThemeManager {
      constructor() {
        this.themeIndex = 0;
        this.themes = [
          { bg: "#002B60", card: "#01356F" },
          { bg: "#003B4F", card: "#015C6F" },
          { bg: "#2B004F", card: "#3A006F" }
        ];
      }

      toggleDarkMode() {
        document.body.classList.toggle("dark");
      }

      cycleTheme() {
        this.themeIndex = (this.themeIndex + 1) % this.themes.length;

        document.body.style.backgroundColor = this.themes[this.themeIndex].bg;

        const card = document.querySelector(".card");
        if (card) {
          card.style.backgroundColor = this.themes[this.themeIndex].card;
        }
      }
    }

    /* ============================================================
       CLASS: CategoryModal
    ============================================================ */
    class CategoryModal {
      constructor(uiBinder, engine) {
        this.ui = uiBinder;
        this.engine = engine;

        this.modal = document.getElementById("categoryModal");
        this.list = document.getElementById("categoryList");

        this.buildOptions();
        this.bindBackdrop();
      }

      buildOptions() {
        const categories = Object.keys(this.engine.categories);

        this.list.innerHTML = categories
          .map(cat => `<div class="modal-option-btn" data-cat="${cat}">${cat}</div>`)
          .join("");

        this.list.querySelectorAll(".modal-option-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            const selected = btn.dataset.cat;
            this.ui.setCategory(selected);
            this.hide();
          });
        });
      }

      bindBackdrop() {
        this.modal.addEventListener("click", e => {
          if (e.target === this.modal) this.hide();
        });
      }

      show() {
        this.modal.classList.remove("hidden");
      }

      hide() {
        this.modal.classList.add("hidden");
      }
    }

    /* ============================================================
       CLASS: ToolbarController
    ============================================================ */
    class ToolbarController {
      constructor(themeManager, modal) {
        this.themeManager = themeManager;
        this.modal = modal;
      }

      bind() {
        const modeBtn = document.getElementById("modeBtn");
        const themeBtn = document.getElementById("themeBtn");
        const categoryBtn = document.getElementById("categoryBtn");

        modeBtn.addEventListener("click", () => {
          this.themeManager.toggleDarkMode();
          this.addHaptic(modeBtn);
        });

        themeBtn.addEventListener("click", () => {
          this.themeManager.cycleTheme();
          this.addHaptic(themeBtn);
        });

        categoryBtn.addEventListener("click", () => {
          this.modal.show();
          this.addHaptic(categoryBtn);
        });
      }

      addHaptic(el) {
        el.classList.remove("haptic-tap");
        void el.offsetWidth; // force reflow
        el.classList.add("haptic-tap");
      }
    }

    /* ============================================================
       CLASS: UIBinder
    ============================================================ */
    class UIBinder {
      constructor(engine) {
        this.engine = engine;

        this.fromEl = document.getElementById("fromUnit");
        this.toEl = document.getElementById("toUnit");
        this.inputEl = document.getElementById("inputValue");
        this.resultEl = document.getElementById("result");
        this.swapBtn = document.getElementById("swapBtn");

        this.currentCategory = "volume";
      }

      init() {
        this.setCategory(this.currentCategory);
        this.bindEvents();
      }

      setCategory(category) {
        this.currentCategory = category;

        const units = this.engine.getUnits(category);
        const defaults = this.engine.getDefaultUnits(category);

        this.fromEl.innerHTML = units.map(u => `<option value="${u}">${u}</option>`).join("");
        this.toEl.innerHTML = units.map(u => `<option value="${u}">${u}</option>`).join("");

        if (defaults.length === 2) {
          this.fromEl.value = defaults[0];
          this.toEl.value = defaults[1];
        }

        this.updateResult();
      }

      bindEvents() {
        this.inputEl.addEventListener("input", () => this.updateResult());
        this.fromEl.addEventListener("change", () => this.updateResult());
        this.toEl.addEventListener("change", () => this.updateResult());

        this.swapBtn.addEventListener("click", () => {
          const temp = this.fromEl.value;
          this.fromEl.value = this.toEl.value;
          this.toEl.value = temp;
          this.updateResult();
          this.addHaptic(this.swapBtn);
        });
      }

      updateResult() {
        const value = parseFloat(this.inputEl.value);
        const from = this.fromEl.value;
        const to = this.toEl.value;

        const result = this.engine.convert(this.currentCategory, value, from, to);

        if (result === "" || isNaN(result)) {
          this.resultEl.textContent = "";
          return;
        }

        this.resultEl.textContent = result.toFixed(2);
        this.resultEl.classList.remove("result-updated");
        void this.resultEl.offsetWidth;
        this.resultEl.classList.add("result-updated");
      }

      addHaptic(el) {
        el.classList.remove("haptic-tap");
        void el.offsetWidth;
        el.classList.add("haptic-tap");
      }
    }

    /* ============================================================
       APP INITIALIZATION
    ============================================================ */
    window.addEventListener("DOMContentLoaded", () => {
      const engine = new ConverterEngine();
      const ui = new UIBinder(engine);
      const themeManager = new ThemeManager();
      const modal = new CategoryModal(ui, engine);
      const toolbar = new ToolbarController(themeManager, modal);

      ui.init();
      toolbar.bind();
    });
  </script>

</body>
</html>
